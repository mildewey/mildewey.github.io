import{S as N,i as A,s as L,e as $,c as y,a as b,d as m,g,r as p,x as S,k as E,y as j,m as k,z as O,F as v,p as d,C,o as P,q as B,G as Q,l as F,t as z,h as R,j as W,b as K,H as X,I as Z,J as I,K as x}from"../chunks/index-6a66f5b0.js";import{j as D}from"../chunks/controls-ef78b98b.js";async function T(o,e){const t=await(await e(o)).text();return D.load(t)}async function ee(o,e){const n=await Promise.all(o.elements.map(t=>T(t,e)));return Object.assign(...n)}async function te(o,e){const n=await Promise.all(o.prototypes.map(t=>T(t,e)));return Object.assign(...n)}function le(o,e){return Object.entries(e).forEach(([n,t])=>{n in o?o[n]+=t:o[n]=t}),o}function M(o,e,n,t){if(!(t in o.elements))return console.log(`Couldn't find ${t} in system ${o.name}.`),!1;let s=o.elements[t];return"powers"in s&&s.powers.forEach(a=>e.powers.add(a)),"stats"in s&&le(e.stats,s.stats),"slots"in s&&Object.keys(s.slots).forEach(a=>{const l=s.slots[a],i=`${t}.${a}`;e.slots[i]={name:l.name,options:Object.assign({null:{name:"Unselected"}},...l.allowedTags.map(r=>o.tags[r]))},M(o,e,n,n.elements[i])}),"upgrades"in s&&(e.upgrades[t]={name:s.name,options:{}},s.upgrades.forEach(a=>{e.upgrades[t].options[a]=o.elements[a]}),n.elements[`${t}.upgrades`].forEach(a=>{M(o,e,n,a)&&(e.level+=1)})),!0}function ne(o,e){const n={name:e.name,blurb:e.blurb,level:0,stats:{},slots:{},upgrades:{},powers:new Set};return M(o,n,e,e.elements.character),n.powers=[...n.powers.values()],n}async function se(o,e){const n=await T(`/${o}/index.yaml`,e),t={name:n.name,elements:"elements"in n?await ee(n,e):{},prototypes:"prototypes"in n?await te(n,e):{},tags:{}};return Object.entries(t.elements).forEach(([s,a])=>{t.elements[s].tags.forEach(l=>{l in t.tags||(t.tags[l]={}),t.tags[l][s]=a})}),t.inflateCharacter=s=>ne(t,s),t}function U(o,e,n){const t=o.slice();return t[1]=e[n],t}function ae(o){let e,n=o[0].label+"",t;return{c(){e=$("p"),t=z(n)},l(s){e=y(s,"P",{});var a=b(e);t=R(a,n),a.forEach(m)},m(s,a){g(s,e,a),v(e,t)},p(s,a){a&1&&n!==(n=s[0].label+"")&&W(t,n)},d(s){s&&m(e)}}}function re(o){let e,n=o[0].label+"",t,s;return{c(){e=$("a"),t=z(n),this.h()},l(a){e=y(a,"A",{href:!0});var l=b(e);t=R(l,n),l.forEach(m),this.h()},h(){K(e,"href",s=o[0].href)},m(a,l){g(a,e,l),v(e,t)},p(a,l){l&1&&n!==(n=a[0].label+"")&&W(t,n),l&1&&s!==(s=a[0].href)&&K(e,"href",s)},d(a){a&&m(e)}}}function Y(o){let e,n,t=o[0].children,s=[];for(let l=0;l<t.length;l+=1)s[l]=G(U(o,t,l));const a=l=>d(s[l],1,1,()=>{s[l]=null});return{c(){e=$("ul");for(let l=0;l<s.length;l+=1)s[l].c()},l(l){e=y(l,"UL",{});var i=b(e);for(let r=0;r<s.length;r+=1)s[r].l(i);i.forEach(m)},m(l,i){g(l,e,i);for(let r=0;r<s.length;r+=1)s[r].m(e,null);n=!0},p(l,i){if(i&1){t=l[0].children;let r;for(r=0;r<t.length;r+=1){const f=U(l,t,r);s[r]?(s[r].p(f,i),p(s[r],1)):(s[r]=G(f),s[r].c(),p(s[r],1),s[r].m(e,null))}for(P(),r=t.length;r<s.length;r+=1)a(r);B()}},i(l){if(!n){for(let i=0;i<t.length;i+=1)p(s[i]);n=!0}},o(l){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)d(s[i]);n=!1},d(l){l&&m(e),Q(s,l)}}}function G(o){let e,n,t,s;return n=new V({props:{nav:o[1]}}),{c(){e=$("li"),S(n.$$.fragment),t=E()},l(a){e=y(a,"LI",{});var l=b(e);j(n.$$.fragment,l),t=k(l),l.forEach(m)},m(a,l){g(a,e,l),O(n,e,null),v(e,t),s=!0},p(a,l){const i={};l&1&&(i.nav=a[1]),n.$set(i)},i(a){s||(p(n.$$.fragment,a),s=!0)},o(a){d(n.$$.fragment,a),s=!1},d(a){a&&m(e),C(n)}}}function oe(o){let e,n,t;function s(r,f){return r[0].href?re:ae}let a=s(o),l=a(o),i=o[0].children&&Y(o);return{c(){l.c(),e=E(),i&&i.c(),n=F()},l(r){l.l(r),e=k(r),i&&i.l(r),n=F()},m(r,f){l.m(r,f),g(r,e,f),i&&i.m(r,f),g(r,n,f),t=!0},p(r,[f]){a===(a=s(r))&&l?l.p(r,f):(l.d(1),l=a(r),l&&(l.c(),l.m(e.parentNode,e))),r[0].children?i?(i.p(r,f),f&1&&p(i,1)):(i=Y(r),i.c(),p(i,1),i.m(n.parentNode,n)):i&&(P(),d(i,1,1,()=>{i=null}),B())},i(r){t||(p(i),t=!0)},o(r){d(i),t=!1},d(r){l.d(r),r&&m(e),i&&i.d(r),r&&m(n)}}}function ie(o,e,n){let{nav:t}=e;return o.$$set=s=>{"nav"in s&&n(0,t=s.nav)},[t]}class V extends N{constructor(e){super(),A(this,e,ie,oe,L,{nav:0})}}function fe(o){let e,n;return e=new V({props:{nav:o[0]}}),{c(){S(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,s){O(e,t,s),n=!0},p(t,[s]){const a={};s&1&&(a.nav=t[0]),e.$set(a)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function ue(o,e,n){let t,{sys:s}=e,{sysKey:a}=e;return o.$$set=l=>{"sys"in l&&n(1,s=l.sys),"sysKey"in l&&n(2,a=l.sysKey)},o.$$.update=()=>{o.$$.dirty&6&&n(0,t={label:s.name,children:[{label:"Elements",children:Object.entries(s.elements).map(([l,i])=>({label:i.name,href:`/${a}/element/${l}`}))},{label:"Prototypes",children:Object.entries(s.prototypes).map(([l,i])=>({label:i.name,href:`/${a}/prototype/${l}`}))},{label:"Characters"},{label:"Adversaries"}]})},[t,s,a]}class ce extends N{constructor(e){super(),A(this,e,ue,fe,L,{sys:1,sysKey:2})}}function H(o,e,n){const t=o.slice();return t[2]=e[n][0],t[3]=e[n][1],t}function J(o){let e,n;return e=new ce({props:{sysKey:o[2],sys:o[3]}}),{c(){S(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,s){O(e,t,s),n=!0},p(t,s){const a={};s&1&&(a.sysKey=t[2]),s&1&&(a.sys=t[3]),e.$set(a)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function me(o){let e,n,t,s;n=new V({props:{nav:o[1]}});let a=Object.entries(o[0]),l=[];for(let r=0;r<a.length;r+=1)l[r]=J(H(o,a,r));const i=r=>d(l[r],1,1,()=>{l[r]=null});return{c(){e=$("nav"),S(n.$$.fragment),t=E();for(let r=0;r<l.length;r+=1)l[r].c()},l(r){e=y(r,"NAV",{});var f=b(e);j(n.$$.fragment,f),t=k(f);for(let c=0;c<l.length;c+=1)l[c].l(f);f.forEach(m)},m(r,f){g(r,e,f),O(n,e,null),v(e,t);for(let c=0;c<l.length;c+=1)l[c].m(e,null);s=!0},p(r,[f]){if(f&1){a=Object.entries(r[0]);let c;for(c=0;c<a.length;c+=1){const _=H(r,a,c);l[c]?(l[c].p(_,f),p(l[c],1)):(l[c]=J(_),l[c].c(),p(l[c],1),l[c].m(e,null))}for(P(),c=a.length;c<l.length;c+=1)i(c);B()}},i(r){if(!s){p(n.$$.fragment,r);for(let f=0;f<a.length;f+=1)p(l[f]);s=!0}},o(r){d(n.$$.fragment,r),l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)d(l[f]);s=!1},d(r){r&&m(e),C(n),Q(l,r)}}}function _e(o,e,n){let{allSystems:t}=e,s={label:"Rules",children:[{label:"Combat",href:"/rules/combat"},{label:"Building a Character",href:"/rules/character"}]};return o.$$set=a=>{"allSystems"in a&&n(0,t=a.allSystems)},[t,s]}class pe extends N{constructor(e){super(),A(this,e,_e,me,L,{allSystems:0})}}function he(o){let e,n,t,s,a,l,i,r,f;e=new pe({props:{allSystems:o[0]}});const c=o[2].default,_=X(c,o,o[1],null);return{c(){S(e.$$.fragment),n=E(),t=$("main"),_&&_.c(),s=E(),a=$("footer"),l=$("small"),i=z("built with Ersatz\u2122 \xA9 Mark Dewey and Stuart Cheney"),r=$("br"),this.h()},l(u){j(e.$$.fragment,u),n=k(u),t=y(u,"MAIN",{});var h=b(t);_&&_.l(h),h.forEach(m),s=k(u),a=y(u,"FOOTER",{class:!0});var w=b(a);l=y(w,"SMALL",{class:!0});var q=b(l);i=R(q,"built with Ersatz\u2122 \xA9 Mark Dewey and Stuart Cheney"),q.forEach(m),r=y(w,"BR",{}),w.forEach(m),this.h()},h(){K(l,"class","dragonsteel"),K(a,"class","dragonsteel")},m(u,h){O(e,u,h),g(u,n,h),g(u,t,h),_&&_.m(t,null),g(u,s,h),g(u,a,h),v(a,l),v(l,i),v(a,r),f=!0},p(u,[h]){const w={};h&1&&(w.allSystems=u[0]),e.$set(w),_&&_.p&&(!f||h&2)&&Z(_,c,u,u[1],f?x(c,u[1],h,null):I(u[1]),null)},i(u){f||(p(e.$$.fragment,u),p(_,u),f=!0)},o(u){d(e.$$.fragment,u),d(_,u),f=!1},d(u){C(e,u),u&&m(n),u&&m(t),_&&_.d(u),u&&m(s),u&&m(a)}}}async function ye({params:o,fetch:e,session:n,stuff:t}){let s={goliath:await se("goliath",e)};return{status:200,props:{allSystems:s},stuff:{allSystems:s}}}function de(o,e,n){let{$$slots:t={},$$scope:s}=e,{allSystems:a}=e;return o.$$set=l=>{"allSystems"in l&&n(0,a=l.allSystems),"$$scope"in l&&n(1,s=l.$$scope)},[a,s,t]}class be extends N{constructor(e){super(),A(this,e,de,he,L,{allSystems:0})}}export{be as default,ye as load};
