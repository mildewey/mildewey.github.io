import{S as A,i as K,s as L,e as $,c as b,a as y,d as p,g as d,r as _,x as k,k as E,y as j,m as S,z as O,F as v,p as g,C,o as P,q as B,G as Q,l as q,t as T,h as z,j as W,b as N,H as X,I as Z,J as x,K as I}from"../chunks/index-432774c0.js";import{j as D}from"../chunks/controls-ef78b98b.js";import{a as ee}from"../chunks/navigation-13fd7038.js";import"../chunks/singletons-d1fb5791.js";async function R(o,e){const t=await(await e(o)).text();return D.load(t)}async function te(o,e){const l=await Promise.all(o.elements.map(t=>R(t,e)));return Object.assign(...l)}async function le(o,e){const l=await Promise.all(o.prototypes.map(t=>R(t,e)));return Object.assign(...l)}function ne(o,e){return Object.entries(e).forEach(([l,t])=>{l in o?o[l]+=t:o[l]=t}),o}function M(o,e,l,t){if(!(t in o.elements))return console.log(`Couldn't find ${t} in system ${o.name}.`),!1;let n=o.elements[t];return"powers"in n&&n.powers.forEach(r=>e.powers.add(r)),"stats"in n&&ne(e.stats,n.stats),"slots"in n&&Object.keys(n.slots).forEach(r=>{const s=n.slots[r],i=`${t}.${r}`;e.slots[i]={name:s.name,options:Object.assign({unselected:{name:"Unselected"}},...s.allowedTags.map(a=>o.tags[a]))},M(o,e,l,l.elements[i])}),"upgrades"in n&&(e.upgrades[t]={name:n.name,options:{}},n.upgrades.forEach(r=>{e.upgrades[t].options[r]=o.elements[r]}),`${t}.upgrades`in l.elements?l.elements[`${t}.upgrades`].forEach(r=>{M(o,e,l,r)&&(e.level+=1)}):l.elements[`${t}.upgrades`]=[]),!0}function se(o,e){const l={name:e.name,blurb:e.blurb,level:0,stats:{},slots:{character:{name:"Character Type",options:Object.assign({null:{name:"Unselected"}},o.tags.character)}},upgrades:{},powers:new Set};return M(o,l,e,e.elements.character),l.powers=[...l.powers.values()],l}async function ae(o,e){const l=await R(`/${o}/index.yaml`,e),t={sysID:o,name:l.name,elements:"elements"in l?await te(l,e):{},prototypes:"prototypes"in l?await le(l,e):{},tags:{}};return Object.entries(t.elements).forEach(([n,r])=>{t.elements[n].tags.forEach(s=>{s in t.tags||(t.tags[s]={}),t.tags[s][n]=r})}),t.inflateCharacter=n=>se(t,n),t}function F(o,e,l){const t=o.slice();return t[1]=e[l],t}function re(o){let e,l=o[0].label+"",t;return{c(){e=$("p"),t=T(l)},l(n){e=b(n,"P",{});var r=y(e);t=z(r,l),r.forEach(p)},m(n,r){d(n,e,r),v(e,t)},p(n,r){r&1&&l!==(l=n[0].label+"")&&W(t,l)},d(n){n&&p(e)}}}function oe(o){let e,l=o[0].label+"",t,n;return{c(){e=$("a"),t=T(l),this.h()},l(r){e=b(r,"A",{href:!0});var s=y(e);t=z(s,l),s.forEach(p),this.h()},h(){N(e,"href",n=o[0].href)},m(r,s){d(r,e,s),v(e,t)},p(r,s){s&1&&l!==(l=r[0].label+"")&&W(t,l),s&1&&n!==(n=r[0].href)&&N(e,"href",n)},d(r){r&&p(e)}}}function J(o){let e,l,t=o[0].children,n=[];for(let s=0;s<t.length;s+=1)n[s]=Y(F(o,t,s));const r=s=>g(n[s],1,1,()=>{n[s]=null});return{c(){e=$("ul");for(let s=0;s<n.length;s+=1)n[s].c()},l(s){e=b(s,"UL",{});var i=y(e);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(p)},m(s,i){d(s,e,i);for(let a=0;a<n.length;a+=1)n[a].m(e,null);l=!0},p(s,i){if(i&1){t=s[0].children;let a;for(a=0;a<t.length;a+=1){const f=F(s,t,a);n[a]?(n[a].p(f,i),_(n[a],1)):(n[a]=Y(f),n[a].c(),_(n[a],1),n[a].m(e,null))}for(P(),a=t.length;a<n.length;a+=1)r(a);B()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)_(n[i]);l=!0}},o(s){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)g(n[i]);l=!1},d(s){s&&p(e),Q(n,s)}}}function Y(o){let e,l,t,n;return l=new U({props:{nav:o[1]}}),{c(){e=$("li"),k(l.$$.fragment),t=E()},l(r){e=b(r,"LI",{});var s=y(e);j(l.$$.fragment,s),t=S(s),s.forEach(p)},m(r,s){d(r,e,s),O(l,e,null),v(e,t),n=!0},p(r,s){const i={};s&1&&(i.nav=r[1]),l.$set(i)},i(r){n||(_(l.$$.fragment,r),n=!0)},o(r){g(l.$$.fragment,r),n=!1},d(r){r&&p(e),C(l)}}}function ie(o){let e,l,t;function n(a,f){return a[0].href?oe:re}let r=n(o),s=r(o),i=o[0].children&&J(o);return{c(){s.c(),e=E(),i&&i.c(),l=q()},l(a){s.l(a),e=S(a),i&&i.l(a),l=q()},m(a,f){s.m(a,f),d(a,e,f),i&&i.m(a,f),d(a,l,f),t=!0},p(a,[f]){r===(r=n(a))&&s?s.p(a,f):(s.d(1),s=r(a),s&&(s.c(),s.m(e.parentNode,e))),a[0].children?i?(i.p(a,f),f&1&&_(i,1)):(i=J(a),i.c(),_(i,1),i.m(l.parentNode,l)):i&&(P(),g(i,1,1,()=>{i=null}),B())},i(a){t||(_(i),t=!0)},o(a){g(i),t=!1},d(a){s.d(a),a&&p(e),i&&i.d(a),a&&p(l)}}}function fe(o,e,l){let{nav:t}=e;return o.$$set=n=>{"nav"in n&&l(0,t=n.nav)},[t]}class U extends A{constructor(e){super(),K(this,e,fe,ie,L,{nav:0})}}function ce(o){let e,l;return e=new U({props:{nav:o[0]}}),{c(){k(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){O(e,t,n),l=!0},p(t,[n]){const r={};n&1&&(r.nav=t[0]),e.$set(r)},i(t){l||(_(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){C(e,t)}}}function ue(o,e,l){let{sys:t}=e,{sysKey:n}=e,r={};function s(i){return JSON.parse(localStorage.getItem(`${i}-characters`)||"{}")}return ee((i,a)=>{const f=s(n);l(0,r={label:t.name,children:[{label:"Elements",children:Object.entries(t.elements).map(([c,m])=>({label:m.name,href:`/${n}/element/${c}`}))},{label:"Prototypes",children:Object.entries(t.prototypes).map(([c,m])=>({label:m.name,href:`/${n}/prototype/${c}`}))},{label:"Characters",children:[{label:"New Character",href:`/${n}/character/new`},...Object.entries(f).map(([c,m])=>({label:m.name,href:`/${n}/character/${c}`}))]},{label:"Adversaries"}]})}),o.$$set=i=>{"sys"in i&&l(1,t=i.sys),"sysKey"in i&&l(2,n=i.sysKey)},[r,t,n]}class me extends A{constructor(e){super(),K(this,e,ue,ce,L,{sys:1,sysKey:2})}}function G(o,e,l){const t=o.slice();return t[2]=e[l][0],t[3]=e[l][1],t}function H(o){let e,l;return e=new me({props:{sysKey:o[2],sys:o[3]}}),{c(){k(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){O(e,t,n),l=!0},p(t,n){const r={};n&1&&(r.sysKey=t[2]),n&1&&(r.sys=t[3]),e.$set(r)},i(t){l||(_(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){C(e,t)}}}function pe(o){let e,l,t,n;l=new U({props:{nav:o[1]}});let r=Object.entries(o[0]),s=[];for(let a=0;a<r.length;a+=1)s[a]=H(G(o,r,a));const i=a=>g(s[a],1,1,()=>{s[a]=null});return{c(){e=$("nav"),k(l.$$.fragment),t=E();for(let a=0;a<s.length;a+=1)s[a].c()},l(a){e=b(a,"NAV",{});var f=y(e);j(l.$$.fragment,f),t=S(f);for(let c=0;c<s.length;c+=1)s[c].l(f);f.forEach(p)},m(a,f){d(a,e,f),O(l,e,null),v(e,t);for(let c=0;c<s.length;c+=1)s[c].m(e,null);n=!0},p(a,[f]){if(f&1){r=Object.entries(a[0]);let c;for(c=0;c<r.length;c+=1){const m=G(a,r,c);s[c]?(s[c].p(m,f),_(s[c],1)):(s[c]=H(m),s[c].c(),_(s[c],1),s[c].m(e,null))}for(P(),c=r.length;c<s.length;c+=1)i(c);B()}},i(a){if(!n){_(l.$$.fragment,a);for(let f=0;f<r.length;f+=1)_(s[f]);n=!0}},o(a){g(l.$$.fragment,a),s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)g(s[f]);n=!1},d(a){a&&p(e),C(l),Q(s,a)}}}function _e(o,e,l){let{allSystems:t}=e,n={label:"Rules",children:[{label:"Combat",href:"/rules/combat"},{label:"Building a Character",href:"/rules/character"}]};return o.$$set=r=>{"allSystems"in r&&l(0,t=r.allSystems)},[t,n]}class he extends A{constructor(e){super(),K(this,e,_e,pe,L,{allSystems:0})}}function ge(o){let e,l,t,n,r,s,i,a,f;e=new he({props:{allSystems:o[0]}});const c=o[2].default,m=X(c,o,o[1],null);return{c(){k(e.$$.fragment),l=E(),t=$("main"),m&&m.c(),n=E(),r=$("footer"),s=$("small"),i=T("built with Ersatz\u2122 \xA9 Mark Dewey and Stuart Cheney"),a=$("br"),this.h()},l(u){j(e.$$.fragment,u),l=S(u),t=b(u,"MAIN",{});var h=y(t);m&&m.l(h),h.forEach(p),n=S(u),r=b(u,"FOOTER",{class:!0});var w=y(r);s=b(w,"SMALL",{class:!0});var V=y(s);i=z(V,"built with Ersatz\u2122 \xA9 Mark Dewey and Stuart Cheney"),V.forEach(p),a=b(w,"BR",{}),w.forEach(p),this.h()},h(){N(s,"class","dragonsteel"),N(r,"class","dragonsteel")},m(u,h){O(e,u,h),d(u,l,h),d(u,t,h),m&&m.m(t,null),d(u,n,h),d(u,r,h),v(r,s),v(s,i),v(r,a),f=!0},p(u,[h]){const w={};h&1&&(w.allSystems=u[0]),e.$set(w),m&&m.p&&(!f||h&2)&&Z(m,c,u,u[1],f?I(c,u[1],h,null):x(u[1]),null)},i(u){f||(_(e.$$.fragment,u),_(m,u),f=!0)},o(u){g(e.$$.fragment,u),g(m,u),f=!1},d(u){C(e,u),u&&p(l),u&&p(t),m&&m.d(u),u&&p(n),u&&p(r)}}}async function we({params:o,fetch:e,session:l,stuff:t}){let n={goliath:await ae("goliath",e)};return{status:200,props:{allSystems:n},stuff:{allSystems:n}}}function de(o,e,l){let{$$slots:t={},$$scope:n}=e,{allSystems:r}=e;return o.$$set=s=>{"allSystems"in s&&l(0,r=s.allSystems),"$$scope"in s&&l(1,n=s.$$scope)},[r,n,t]}class Ee extends A{constructor(e){super(),K(this,e,de,ge,L,{allSystems:0})}}export{Ee as default,we as load};
